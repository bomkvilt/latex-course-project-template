\addModuleCode
{
    \usepackage{fontspec}
    \usepackage{polyglossia}[2014/05/21]
    \usepackage{xecyr}
    \usepackage{mathtext}
    \usepackage{indentfirst}
    \usepackage{misccorr}

} {
    % set main and additional languages
    \setmainlanguage[babelshorthands=true,indentfirst=true]{russian}
    \setotherlanguage{english}

    \setmainfont {Times New Roman}
    \setromanfont{Times New Roman} 
    \setsansfont {Arial} 
    \setmonofont {Courier New} 

    \newfontfamily{\cyrillicfont}  {Times New Roman} 
    \newfontfamily{\cyrillicfontrm}{Times New Roman}
    \newfontfamily{\cyrillicfonttt}{Courier New}
    \newfontfamily{\cyrillicfontsf}{Arial}

    \DeclareSymbolFont{cyrletters}{\encodingdefault}{\familydefault}{m}{it}
    \newcommand{\makecyrmathletter}[1]
    {
        \begingroup\lccode`a=#1\lowercase{\endgroup
        \Umathcode`a}="0 \csname symcyrletters\endcsname\space #1
    }
    \count255="409
    \loop\ifnum\count255<"44F
        \advance\count255 by 1
        \makecyrmathletter{\count255}
    \repeat
}
